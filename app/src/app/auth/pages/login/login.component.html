<div class="login-container">
  <div class="login-card">
    <!-- Header da página de login -->
    <div class="login-header">
      <button class="back-button"
              (click)="goBack()"
              aria-label="Voltar">
        <svg width="24"
             height="24"
             viewBox="0 0 24 24"
             fill="none"
             xmlns="http://www.w3.org/2000/svg">
          <path d="M19 12H5M12 19L5 12L12 5"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round" />
        </svg>
      </button>

      <div class="brand">
        <div class="logo-icon">
          <span class="logo-text">N</span>
        </div>
        <span class="brand-name">NORMATIZE</span>
      </div>
    </div>

    <!-- Formulário de login -->
    <div class="login-content"
         *ngIf="!showForgotPassword">
      <div class="login-title">
        <h1>Entrar na sua conta</h1>
        <p>Entre para continuar formatando seus documentos</p>
      </div>

      <form (ngSubmit)="onSubmit()"
            class="login-form">
        <div class="form-group">
          <label for="email">E-mail</label>
          <input type="email"
                 id="email"
                 name="email"
                 [(ngModel)]="email"
                 placeholder="Digite seu e-mail"
                 required
                 autocomplete="email" />
        </div>

        <div class="form-group">
          <label for="password">Senha</label>
          <input type="password"
                 id="password"
                 name="password"
                 [(ngModel)]="password"
                 placeholder="Digite sua senha"
                 required
                 autocomplete="current-password" />
        </div>

        <div class="form-options">
          <label class="checkbox-label">
            <input type="checkbox"
                   name="remember">
            <span class="checkmark"></span>
            Lembrar de mim
          </label>

          <a (click)="showForgotPasswordForm($event)"
             class="forgot-password">Esqueceu a senha?</a>
        </div>

        <button type="submit"
                class="btn btn-primary login-button"
                [disabled]="!email || !password || isLoading">
          <span *ngIf="!isLoading">Entrar</span>
          <span *ngIf="isLoading"
                class="loading-spinner">
            <svg width="20"
                 height="20"
                 viewBox="0 0 24 24"
                 fill="none"
                 xmlns="http://www.w3.org/2000/svg">
              <circle cx="12"
                      cy="12"
                      r="10"
                      stroke="currentColor"
                      stroke-width="2"
                      opacity="0.3" />
              <path d="M12 2v4"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round">
                <animateTransform attributeName="transform"
                                  type="rotate"
                                  values="0 12 12;360 12 12"
                                  dur="1s"
                                  repeatCount="indefinite" />
              </path>
            </svg>
            Entrando...
          </span>
        </button>
      </form>

      <div class="signup-link">
        <p>Ainda não tem uma conta? <a (click)="navigateToRegister($event)">Criar conta gratuita</a></p>
      </div>
    </div>

    <!-- Formulário de recuperação de senha -->
    <div class="login-content"
         *ngIf="showForgotPassword">
      <div class="login-title">
        <h1>Recuperar senha</h1>
        <p>Digite seu email para receber instruções de recuperação</p>
      </div>

      <form (ngSubmit)="sendRecoveryEmail()"
            class="recovery-form">
        <div class="form-group">
          <label for="recovery-email">E-mail</label>
          <input type="email"
                 id="recovery-email"
                 name="recovery-email"
                 [(ngModel)]="forgotPasswordEmail"
                 placeholder="Digite seu e-mail"
                 required
                 autocomplete="email" />
        </div>

        <!-- Mensagem de feedback -->
        <div class="recovery-message"
             *ngIf="recoveryMessage"
             [ngClass]="'message-' + recoveryMessageType">
          <div class="message-icon">
            <svg *ngIf="recoveryMessageType === 'success'"
                 width="20"
                 height="20"
                 viewBox="0 0 24 24"
                 fill="none"
                 xmlns="http://www.w3.org/2000/svg">
              <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round" />
            </svg>
            <svg *ngIf="recoveryMessageType === 'error'"
                 width="20"
                 height="20"
                 viewBox="0 0 24 24"
                 fill="none"
                 xmlns="http://www.w3.org/2000/svg">
              <circle cx="12"
                      cy="12"
                      r="9"
                      stroke="currentColor"
                      stroke-width="2" />
              <path d="M15 9L9 15M9 9L15 15"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round" />
            </svg>
          </div>
          <p>{{ recoveryMessage }}</p>
        </div>

        <div class="form-actions">
          <button type="submit"
                  class="btn btn-primary recovery-button"
                  [disabled]="!forgotPasswordEmail || isRecoveryLoading">
            <span *ngIf="!isRecoveryLoading">Enviar instruções</span>
            <span *ngIf="isRecoveryLoading"
                  class="loading-spinner">
              <svg width="20"
                   height="20"
                   viewBox="0 0 24 24"
                   fill="none"
                   xmlns="http://www.w3.org/2000/svg">
                <circle cx="12"
                        cy="12"
                        r="10"
                        stroke="currentColor"
                        stroke-width="2"
                        opacity="0.3" />
                <path d="M12 2v4"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round">
                  <animateTransform attributeName="transform"
                                    type="rotate"
                                    values="0 12 12;360 12 12"
                                    dur="1s"
                                    repeatCount="indefinite" />
                </path>
              </svg>
              Enviando...
            </span>
          </button>

          <button type="button"
                  class="btn btn-secondary back-to-login"
                  (click)="hideForgotPasswordForm()">
            Voltar ao login
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
